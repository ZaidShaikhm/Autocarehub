{% extends 'Autocareapp/adminmenu.html' %}
{% load static %}
{% block content %}
<div class="container py-5">
  <h2 class="mb-4 text-center">Manage Bookings</h2>
  <div class="table-responsive">
    <table class="table table-bordered table-striped align-middle">
      <thead class="table-dark">
        <tr>
          <th>Booking ID</th>
          <th>User ID</th>
          <th>Service Date</th>
          <th>Service</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
        <tr>
          <td>{{ booking.id }}</td>
          <td>{{ booking.user.id }}</td>
          <td>{{ booking.booking_date|date:"Y-m-d" }}</td>
          <td>{{ booking.service }}</td>
          <td>
            {% if booking.status == "Pending" %}
              <span class="badge bg-warning text-dark">Pending</span>
            {% elif booking.status == "Accepted" %}
              <span class="badge bg-primary">Accepted</span>
            {% elif booking.status == "In Progress" %}
              <span class="badge bg-info text-dark">In Progress</span>
            {% elif booking.status == "Completed" %}
              <span class="badge bg-success">Completed</span>
            {% elif booking.status == "Cancelled" %}
              <span class="badge bg-danger">Cancelled</span>
            {% else %}
              <span class="badge bg-secondary">{{ booking.status }}</span>
            {% endif %}
            {% if booking.status == "Pending" %}
              <span class="badge bg-warning text-dark">Pending</span>
            {% elif booking.status == "Accepted" %}
              <span class="badge bg-primary">Accepted</span>
            {% elif booking.status == "In Progress" %}
              <span class="badge bg-info text-dark">In Progress</span>
            {% elif booking.status == "Completed" %}
              <span class="badge bg-success">Completed</span>
            {% elif booking.status == "Cancelled" %}
              <span class="badge bg-danger">Cancelled</span>
            {% else %}
              <span class="badge bg-secondary">{{ booking.status }}</span>
            {% endif %}
          </td>
          <td>
            {% if booking.status != "Completed" and booking.status != "Cancelled" %}
              <form action="{% url 'accept_booking' booking.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary btn-sm mb-1">Accept</button>
              </form>
              <form action="{% url 'inprogress_booking' booking.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-info btn-sm mb-1">In Progress</button>
              </form>
              <form action="{% url 'complete_booking' booking.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-success btn-sm mb-1">Complete</button>
              </form>
              <form action="{% url 'cancel_booking' booking.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm mb-1">Cancel</button>
              </form>
            {% else %}
              <span class="text-muted">No actions available</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center">No bookings found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}